import { cache } from 'react';
import { {{camelCase entity}}Service } from '@/entity/{{dashCase entity}}';
import { {{camelCase entity}}{{pascalCase useCase}}Adapter } from './{{dashCase entity}}-{{dashCase useCase}}.adapter';
import type { ActionResult } from '@/shared/model/action';
import type { {{pascalCase entity}}{{pascalCase useCase}}View } from './{{dashCase entity}}-{{dashCase useCase}}.ui';

// React.cache(): 같은 렌더 패스 내 중복 요청 제거 (per-request dedup)
// 크로스-요청 캐싱이 필요하면 함수 내에 'use cache' + cacheLife() 추가
export const get{{pascalCase entity}}{{pascalCase useCase}} = cache(
  async (id: string): Promise<ActionResult<{{pascalCase entity}}{{pascalCase useCase}}View>> => {
    try {
      const apiData = await {{camelCase entity}}Service.getById(id);
      return { success: true, data: {{camelCase entity}}{{pascalCase useCase}}Adapter.toUI(apiData) };
    } catch {
      return { success: false, data: null, error: 'SERVER_ERROR' };
    }
  },
);
